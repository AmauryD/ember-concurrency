<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>ember-concurrency</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
<meta name="dummy/config/environment" content="%7B%22modulePrefix%22%3A%22dummy%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%2F%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%2C%22_JQUERY_INTEGRATION%22%3Atrue%7D%2C%22APP%22%3A%7B%22name%22%3A%22ember-concurrency%22%2C%22version%22%3A%221.2.0%2Bd066cd71%22%7D%2C%22fastboot%22%3A%7B%22hostWhitelist%22%3A%5B%7B%7D%2C%22ember-concurrency.com%22%5D%7D%2C%22exportApplicationGlobal%22%3Afalse%7D" />
<!-- EMBER_CLI_FASTBOOT_TITLE -->

    <link integrity="" rel="stylesheet" href="/assets/vendor-e754b247f0b14ad5fde0f302404dd7cb.css">
    <link integrity="" rel="stylesheet" href="/assets/dummy-640694e3930703a2e7f6ed809d9835b0.css">
    <link href='//fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>

    
  </head>
  <body>
    <script type="x/boundary" id="fastboot-body-start"></script><div class="ember-view" id="ember317"><div class="container navbar">
  <div class="row">
    <div class="ten columns">
      <h3 style="float:left;">
        ember-concurrency

        <span style="font-size: 0.5em;">
          (v 1.2.0)
        </span>
      </h3>
    </div>
    <div class="one columns">
      <div class="nav-bar-link-outer">
        <a href="/api">API</a>
      </div>
    </div>
    <div class="one columns">
      <div class="nav-bar-link-outer">
        <a href="https://github.com/machty/ember-concurrency" target="_blank" rel="noopener">GitHub</a>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div class="docs row">
    <div class="three columns">
      <div class="side-menu">
            <div class="toc-entry">
                <a href="/docs/introduction" id="ember318" class="ember-view">Home</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/installation" id="ember319" class="ember-view">Installation</a>
            </div>


<!---->            <div class="toc-section-title">
              Introduction
            </div>
            <div class="toc-entry">
                <a href="/docs/tutorial" id="ember320" class="ember-view">Writing Code Without Tasks</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/tutorial/discussion" id="ember321" class="ember-view">Post-Mortem</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/tutorial/refactor" id="ember322" class="ember-view">Refactoring With Tasks</a>
            </div>


<!---->            <div class="toc-section-title">
              Reference
            </div>
            <div class="toc-entry">
                <a href="/docs/task-function-syntax" id="ember323" class="active ember-view">Task Function Syntax</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/task-concurrency" id="ember324" class="ember-view">Managing Task Concurrency</a>
            </div>


                <div class="toc-entry toc-subentry">
                  <a href="/docs/task-concurrency-advanced" id="ember325" class="ember-view">Advanced</a>
                </div>
            <div class="toc-entry">
                <a href="/docs/cancelation" id="ember326" class="ember-view">Cancelation</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/error-vs-cancelation" id="ember327" class="ember-view">Handling Errors</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/child-tasks" id="ember328" class="ember-view">Child Tasks</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/task-groups" id="ember329" class="ember-view">Task Groups</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/derived-state" id="ember330" class="ember-view">Derived State</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/encapsulated-task" id="ember331" class="ember-view">Encapsulated Tasks</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/events" id="ember332" class="ember-view">Awaiting Events / Conditions</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/task-lifecycle-events" id="ember333" class="ember-view">Lifecycle Events</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/testing-debugging" id="ember334" class="ember-view">Testing &amp; Debugging</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/typescript" id="ember335" class="ember-view">TypeScript</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/faq" id="ember336" class="ember-view">FAQ &amp; Fact Sheet</a>
            </div>


<!---->            <div class="toc-section-title">
              Examples
            </div>
            <div class="toc-entry">
                <a href="/docs/examples/loading-ui" id="ember337" class="ember-view">Loading UI</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/examples/autocomplete" id="ember338" class="ember-view">Type-Ahead Search</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/examples/increment-buttons" id="ember339" class="ember-view">Accelerating Increment Buttons</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/examples/ajax-throttling" id="ember340" class="ember-view">AJAX Throttling</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/examples/route-tasks" id="ember341" class="ember-view">Route Tasks</a>
            </div>


<!---->            <div class="toc-entry">
                <a href="/docs/examples/joining-tasks" id="ember342" class="ember-view">Awaiting Multiple Child Tasks</a>
            </div>


<!---->      </div>
    </div>
    <div class="nine columns">
      <div class="row">
    <p class="u-pull-left">
      Previous: <a href="/docs/tutorial/refactor" id="ember343" class="ember-view">Refactoring With Tasks</a>
    </p>

    <p class="u-pull-right">
      Next: <a href="/docs/task-concurrency" id="ember344" class="ember-view">Managing Task Concurrency</a>
    </p>
</div>


      <a title="Edit on Github" href="https://github.com/machty/ember-concurrency/edit/master/tests/dummy/app/docs/task-function-syntax/template.hbs" id="ember345" class="github-edit ember-view"><i class="icon-pencil"></i>
</a>

      <h3>Task Function Syntax</h3>

<p>
  When a task is performed, it runs the code in the task function
  you passed into <code>task()</code>. This function must
  be a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">generator function</a>
  â€” it must use the <code>function *</code> syntax, and cannot
  be just a regular JavaScript function.
</p>

<p>
  This example demonstrates how, in ember-concurrency, generator
  functions behave <em>just like regular functions</em>. Anything you can
  do in a regular function, you can do in a generator function.
</p>

<div id="ember346" class="ember-view"><p>
  <button>Pick Random Number</button>
  
</p>

</div>

<pre id="ember347" class="javascript ember-view">pickRandomNumbers: task(function * () {
  let nums = [];
  for (let i = 0; i &lt; 3; i++) {
    nums.push(Math.floor(Math.random() * 10));
  }

  this.set('status', `My favorite numbers: ${nums.join(', ')}`);
}),
</pre>

<h4>Using the <code>yield</code> keyword</h4>

<p>
  Much of the power of Tasks is unleashed once you start making
  use of the <code>yield</code> keyword within generator functions.
  The <code>yield</code> keyword, when used with a promise, lets you
  pause execution of your task function until that promise resolves, at
  which point the task function will continue running from where it
  had paused.
</p>

<p>
  This example demonstrates how you can <code>yield timeout(1000)</code>
  to pause execution for 1000 ms (one second). The <code>timeout()</code>
  helper function, which <strong>ember-concurrency</strong> provides,
  simply returns a promise that resolves after the specified number of milliseconds.
</p>

<div id="ember348" class="ember-view"><p>
  <button>Wait A Few Seconds</button>
  
</p>
</div>

<pre id="ember349" class="javascript ember-view">waitAFewSeconds: task(function * () {
  this.set('status', "Gimme one second...");
  yield timeout(1000);
  this.set('status', "Gimme one more second...");
  yield timeout(1000);
  this.set('status', "OK, I'm done.");
}),
</pre>

<p>
  When you <code>yield</code> a promise, the <code>yield</code> expression
  evaluates to the resolved value of the promise. In other words, you can
  set a variable equal to a yielded promise, and when the promise resolves,
  the task function will resume and the value stored into that variable will
  be the resolved value of the promise.
</p>

<div id="ember350" class="ember-view"><p>
  <button>Perform myTask</button>
  
</p>

</div>

<pre id="ember351" class="javascript ember-view">myTask: task(function * () {
  this.set('status', `Thinking...`);
  let promise = timeout(1000).then(() =&gt; 123);
  let resolvedValue = yield promise;
  this.set('status', `The value is ${resolvedValue}`);
}),
</pre>

<p>
  If you <code>yield</code> a promise that rejects, the task function will
  throw the rejected value (likely an exception object) from the point in
  task function where the rejecting promise was yielded. This means you can
  use <code>try {} catch(e) {} finally {}</code> blocks, just as you would
  for code that runs synchronously.
</p>

<div id="ember352" class="ember-view"><p>
  <button>Perform myTask</button>
  
</p>

</div>

<pre id="ember353" class="javascript ember-view">myTask: task(function * () {
  this.set('status', `Thinking...`);
  try {
    yield timeout(1000).then(() =&gt; {
      throw "Ahhhhh!!!!";
    });
    this.set('status', `This does not get used!`);
  } catch(e) {
    this.set('status', `Caught value: ${e}`);
  }
}),
</pre>

<p>
  The behavior of yielding promises within task generator functions
  is designed to closely follow the behavior of the proposed
  <a href="https://github.com/tc39/ecmascript-asyncawait">async/await</a>
  syntax, but instead of <code>async function</code>, you use
  <code>function *</code>, and instead of <code>await</code>, you
  use <code>yield</code>.
</p>

<h4>ES Native Class Use (Ember 3.10+ and Ember Octane)</h4>

<p>
  As of Ember 3.10, <code>task()</code> can be used as a decorator, allowing use
  with native ES classes, such as Glimmer components. The usage remains much the
  same, but the syntax is slightly different.
</p>

<p>
  Note as well, the use of the <code>@computed</code> decorator on the native ES
  getter <code>favoriteNumbers</code>. This is required for updates to be
  reflected in the UI, if you were to use it within the template.
</p>

<pre id="ember354" class="javascript ember-view">import Component from '@glimmer/component';
import { tracked } from '@glimmer/tracking';
import { computed } from '@ember/object';
import { task } from 'ember-concurrency';

export default class MyOctaneComponent extends Component {
  @tracked status = null

  @computed('pickRandomNumbers.last.value')
  get favoriteNumbers() {
    if (this.pickRandomNumbers.last) {
      return this.pickRandomNumbers.last.value
    }

    return [];
  }

  @(task(function * () {
    let nums = [];
    for (let i = 0; i &lt; 3; i++) {
      nums.push(Math.floor(Math.random() * 10));
    }

    this.status = `My favorite numbers: ${nums.join(', ')}`;

    return nums;
  })) pickRandomNumbers;
}
</pre>

<p>
  This syntax is a bit verbose compared to the <code>EmberObject</code> syntax.
  There is an experimental (though stable) Ember addon that adds more concise
  decorators, such as decorators on generator methods. See documentation
  for <a href="https://github.com/machty/ember-concurrency-decorators">ember-concurrency-decorators</a>
  for more details on usage.
</p>

<p>
  As decorators in ECMAScript mature through the TC39, improvements will be made
  to the decorator experience with ember-concurrency.
</p>


      <br> <br> <br> <br>

      <div class="row">
    <p class="u-pull-left">
      Previous: <a href="/docs/tutorial/refactor" id="ember355" class="ember-view">Refactoring With Tasks</a>
    </p>

    <p class="u-pull-right">
      Next: <a href="/docs/task-concurrency" id="ember356" class="ember-view">Managing Task Concurrency</a>
    </p>
</div>


    </div>
  </div>
</div>


<div id="ember357" class="ember-notify-cn ember-notify-default ember-view"><!----></div>
</div><script type="x/boundary" id="fastboot-body-end"></script>

    <script src="/assets/vendor-a60f1c4a4d2f010e6af5cf843cd6ab80.js"></script>
    <script src="/assets/dummy-5f8a1922abdebca46b3ce23e131201e2.js"></script>

    
  </body>
</html>
